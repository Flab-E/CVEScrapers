import requests
import time

dlink = [
  "DCS-4602EV-VB1",
  "DPE-SP110",
  "DQS-5000-32Q28/AF",
  "DQS-5000-32S/AB",
  "DQS-5000-32S/AF",
  "DQS-5000-54SQ28/AF",
  "DXS-5000-54S/AF",
  "DXS-5000-54S/AB",
  "DXS-3600-32S/SI",
  "DXS-3600-32S-SE-LIC",
  "DXS-3600-EM-STACK",
  "DXS-3600-EM-4QXS",
  "DXS-3600-EM-8T",
  "DXS-3600-EM-4XT",
  "DXS-3600-EM-8XS",
  "DGS-1100-10MPP",
  "DGS-1100-26MPP",
  "DFL-210-AV-12-LIC",
  "DFL-210-WCF-12-LIC",
  "DFL-210-IPS-12-LIC",
  "DFL-260-AV-12-LIC",
  "DFL-260-IPS-12-LIC",
  "DFL-260-WCF-12-LIC",
  "DFL-800-AV-12-LIC",
  "DFL-800-IPS-12-LIC",
  "DFL-800-WCF-12-LIC",
  "DFL-860-AV-12-LIC",
  "DFL-860-IPS-12-LIC",
  "DFL-1660-AV-12-LIC",
  "DFL-1660-IPS-12-LIC",
  "DFL-1660-WCF-12-LIC",
  "DFL-2560-AV-12-LIC",
  "DFL-2560-IPS-12-LIC",
  "DFL-2560-WCF-12-LIC",
  "DSP-W118-US",
  "DGS-3120-24TC-SE-LIC",
  "DEM-CB100",
  "DGS-3120-48TC-SE-LIC",
  "DXS-3600-16S-SE-LIC",
  "DGS-3620-52P/SI",
  "DES-3200-52",
  "KVM-402",
  "DFE-530TX+",
  "DIR-885L/R",
  "DIR-890L/R",
  "DKVM-CU3",
  "DCS-80-5",
  "DCS-32-4",
  "DES-1008P+",
  "DFL-260E-NB",
  "DFL-1660-NB",
  "DWL-8610AP-KIT",
  "DGS-3120-24TC/SI",
  "DGS-3120-24TC/EI",
  "DGS-3620-28TC/SI",
  "DGS-3620-28SC/SI",
  "DGS-3620-28PC/SI",
  "DGS-3620-52T/SI",
  "DIR-818LW/D",
  "DIR-818LW/R",
  "DIR-818LW/T",
  "DSL-2750B-US",
  "DSN-040",
  "DWA-131/500BH",
  "DWL-2600AP-KIT",
  "2X2-10-49",
  "2X2-50-99",
  "2X2-100",
  "SGM-2410ID-M",
  "SGM-2410ID-M2",
  "SGM-2410ID-M3",
  "DWS-3160-24TC-AP12-LIC",
  "DWS-3160-24TC-AP24-LIC",
  "DWS-3160-24PC-AP12-LIC",
  "DWS-3160-24PC-AP24-LIC",
  "DXS-3600-16S/SI",
  "DGS-3120-48TC/SI",
  "NCB-C6UF-30/3P",
  "NCB-C6UF-30/5P",
  "DCS-35-1",
  "DCS-8300LH-US",
  "DGS-3120-24PC/SI",
  "DGS-3120-48PC/SI",
  "DIR-867-US",
  "COVR-2202-US",
  "DCS-8600LH-US",
  "DIR-2680-US-W",
  "DIR-882-US",
  "DPE-SP110I",
  "DCS-4701E-VB1",
]

for productName in dlink:
  time.sleep(15)
  url = f"https://www.cvedetails.com/api/v1/vulnerability/search?vendorName=D-Link&productType=hardware&productName={productName}&versionString=1&isOverflow=1&isMemoryCurroption=1&isCodeExecution=1"
  headers = {
    'User-Agent': 'Mozilla/5.0',
    'Authorization': "Bearer 48e2cebb1009c8d6179d7ff5f56dfa37045ef98f.eyJzdWIiOjM3NjYsImlhdCI6MTcxMzI5OTEyNywiZXhwIjoxNzI1MDYyNDAwLCJraWQiOjEsImMiOiJVc0EyazRTVDVsa3B4OVRiN044Z0ZrczFOY3JZWWlCOEE3OFZMWHI2WmtZMXRwWmFEdEF5ZDNtclg0Q214NmhFOVI4dlNMaEEifQ==",
    'accept' : '*/*'
  }

  response = requests.request("GET", url, headers=headers)
  print(print(len(response.json()['results'])))

